<!-- @format -->

![](https://raw.githubusercontent.com/tengyuanOasis/image/master/1183435-20170915105226032-1488063174.jpg)

##### ## å‰ç½®çŸ¥è¯†ï¼š

ğŸ‘‰ ä»€ä¹ˆæ˜¯æ„é€ å‡½æ•°ï¼Ÿ

> æ„é€ å‡½æ•°æ˜¯ä¸€ç§ç‰¹æ®Šçš„å‡½æ•°ï¼Œä¸»è¦ç”¨æ¥åˆå§‹åŒ–å¯¹è±¡ï¼Œä¸ºå¯¹è±¡æˆå‘˜å˜èµ‹åˆå§‹å€¼ï¼Œæ€»ä¸`new`ä¸€èµ·ä½¿ç”¨ï¼›
>
> ç‰¹ç‚¹ï¼š
>
> - æ„é€ å‡½æ•°ç”¨äºåˆ›å»ºæŸä¸€ç±»å¯¹è±¡ï¼Œå…¶**é¦–å­—æ¯è¦å¤§å†™**
> - æ„é€ å‡½æ•°è¦**å’Œ new ä¸€èµ·ä½¿ç”¨**æ‰æœ‰æ„ä¹‰

ğŸ‘‰new ä¹‹ååšäº†ä»€ä¹ˆï¼Ÿ

> new åœ¨æ‰§è¡Œæ—¶ä¼šåšå››ä»¶äº‹æƒ…ï¼š
>
> â‘  åœ¨å†…å­˜ä¸­åˆ›å»ºä¸€ä¸ªæ–°çš„ç©ºå¯¹è±¡ã€‚
>
> â‘¡ è®© this æŒ‡å‘è¿™ä¸ªæ–°çš„å¯¹è±¡ã€‚
>
> â‘¢ æ‰§è¡Œæ„é€ å‡½æ•°é‡Œé¢çš„ä»£ç ï¼Œç»™è¿™ä¸ªæ–°å¯¹è±¡æ·»åŠ å±æ€§å’Œæ–¹æ³•ã€‚
>
> â‘£ è¿”å›è¿™ä¸ªæ–°å¯¹è±¡ï¼ˆæ‰€ä»¥æ„é€ å‡½æ•°é‡Œé¢ä¸éœ€è¦ return ï¼‰ã€‚

##### 1ã€ä»€ä¹ˆæ˜¯åŸå‹ & åŸå‹é“¾

- js ä¸­æˆ‘ä»¬ä½¿ç”¨æ„é€ å‡½æ•°åˆ›å»ºå¯¹è±¡ï¼Œæ¯ä¸ª**æ„é€ å‡½æ•°**å†…éƒ¨éƒ½æœ‰ä¸€ä¸ª`prototype`å±æ€§ï¼Œè¿™ä¸ªå±æ€§å€¼æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼ŒåŒ…å«äº†å¯ä»¥é€šè¿‡è¯¥æ„é€ å‡½

  æ•°å…±äº«çš„ä¸€äº›å®ä¾‹å’Œæ–¹æ³• ğŸ‘‰**åŸå‹**

- å½“ä½¿ç”¨æ„é€ å‡½æ•°åˆ›å»ºä¸€ä¸ªå¯¹è±¡åï¼Œè¯¥å¯¹è±¡==å®ä¾‹==å†…éƒ¨åŒ…å«ä¸€ä¸ª`__proto__`æŒ‡é’ˆï¼Œè¯¥æŒ‡é’ˆæŒ‡å‘`Prototype`å±æ€§çš„å€¼

  ```js
  function Person(name, age) {
  	this.name = name;
  	this.age = age;
  }

  Person.prototype.sing = function () {
  	console.log('singing');
  };

  const p1 = new Person('John', 30);
  const p2 = new Person('Mary', 25);

  console.log('p1.sing === p2.sing: ', p1.sing === p2.sing); // true
  ```

- å½“æˆ‘ä»¬è®¿é—®ä¸€ä¸ªæ„é€ å‡½æ•°å®ä¾‹(å¯¹è±¡)çš„æŸä¸ªå±æ€§æ—¶ï¼Œå¦‚æœè¿™ä¸ªå¯¹è±¡å†…éƒ¨ä¸å­˜åœ¨è¯¥å±æ€§ï¼Œé‚£ä¹ˆä»–å°±ä¼šå»è¯¥å¯¹è±¡çš„åŸå‹å¯¹è±¡ä¸­æ‰¾è¿™ä¸ªå±æ€§ï¼Œè¿™ä¸ªåŸå‹å¯¹è±¡ä¹Ÿæœ‰è‡ªå·±çš„åŸå‹ , å°±è¿™æ ·ä¸€å±‚å±‚å¾€ä¸Šæ‰¾ï¼Œç›´åˆ°æ‰¾åˆ°è¯¥å±æ€§ï¼Œæˆ–æ‰¾åˆ°åŸå‹å¯¹è±¡å°½å¤´`Object.prototype.__proto__`çš„å€¼ä¸º null ğŸ‘‰**åŸå‹é“¾(åŸå‹ä¸Šé“¾å¼æŸ¥æ‰¾)**

  ```js
  Object.prototype.sing = function () {
  	console.log("I'm a singleton");
  };

  function Person(name, age) {
  	this.name = name;
  	this.age = age;
  }

  const p1 = new Person('John', 30);

  p1.sing(); //I'm a singleton

  p1.__proto__.sing(); //I'm a singleton

  console.log(p1.__proto__.sing === Person.__proto__.sing); // true

  console.log(Person.__proto__.sing === Object.prototype.sing); //true
  ```

##### 2ã€æ„é€ å‡½æ•°åˆ›å»ºå¯¹è±¡

```js
function Person() {}
var person = new Person();
person.name = 'kevin';
console.log(person.name);
```

##### 3ã€Prototype

æ¯ä¸ªå‡½æ•°éƒ½æœ‰`prototype`å±æ€§

```js
function Person() {}

Person.prototype.name = 'kavin';

var person1 = new Person();
var person2 = new Person();

console.log(person1.name); //kavin
console.log(person2.name); //kavin
```

- å‡½æ•°çš„ prototype å±æ€§æŒ‡å‘äº†ä¸€ä¸ªå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡æ­£æ˜¯è°ƒç”¨è¯¥æ„é€ å‡½æ•°è€Œåˆ›å»ºçš„å®ä¾‹çš„åŸå‹ï¼Œä¹Ÿå°±æ˜¯è¿™ä¸ªä¾‹å­ä¸­çš„ person1 å’Œ person2 çš„åŸå‹ã€‚

- ##### é‚£ä»€ä¹ˆæ˜¯åŸå‹å‘¢ï¼Ÿæ¯ä¸€ä¸ª JavaScript å¯¹è±¡(null é™¤å¤–)åœ¨åˆ›å»ºçš„æ—¶å€™å°±ä¼šä¸ä¹‹å…³è”å¦ä¸€ä¸ªå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡å°±æ˜¯æˆ‘ä»¬æ‰€è¯´çš„åŸå‹ï¼Œæ¯ä¸€ä¸ªå¯¹è±¡éƒ½ä¼šä»åŸå‹ä¸­ç»§æ‰¿å±æ€§

##### 4ã€**æ„é€ å‡½æ•°å’Œå®ä¾‹åŸå‹ä¹‹é—´çš„å…³ç³»**

![](https://raw.githubusercontent.com/mqyqingfeng/Blog/raw/master/Images/prototype1.png)

##### 5ã€`_proto_`

æ¯ä¸€ä¸ª js å¯¹è±¡éƒ½æœ‰ä¸€ä¸ªå±æ€§,å°±æ˜¯`_proto_`,è¿™ä¸ªå±æ€§ä¼šæŒ‡å‘è¯¥å¯¹è±¡çš„åŸå‹

```js
function Person() {}

var person = new Person();

console.log(person.__proto__ === Person.prototype); //true
```

![](https://raw.githubusercontent.com/mqyqingfeng/Blog/raw/master/Images/prototype2.png)

##### 6ã€constructor

consttructor æŒ‡å‘è¯¥æ„é€ å‡½æ•°æœ¬èº«,å³

```js
Person.prototype.constructor = Person;
```

![](https://raw.githubusercontent.com/mqyqingfeng/Blog/raw/master/Images/prototype3.png)

##### 7ã€[åŸå‹é“¾](https://segmentfault.com/a/1190000008959943)

![](https://raw.githubusercontent.com/mqyqingfeng/Blog/raw/master/Images/prototype5.png)

##### 8ã€`prototype`ã€`__proto__`ã€`constructor`å…³ç³»

```js
/**
 * æ„é€ å‡½æ•°å¯ä»¥æ˜¯å‡½æ•°è¡¨è¾¾å¼
 * ä¹Ÿå¯ä»¥æ˜¯å‡½æ•°å£°æ˜ï¼Œå› æ­¤ä»¥ä¸‹ä¸¤ç§å½¢å¼éƒ½å¯ä»¥ï¼š
 *   function Person() {}
 *   let Person = function() {}
 */
function Person() {}

/**
 * å£°æ˜ä¹‹åï¼Œæ„é€ å‡½æ•°å°±æœ‰äº†ä¸€ä¸ªä¸ä¹‹å…³è”çš„åŸå‹å¯¹è±¡ï¼š
 */
console.log(typeof Person.prototype); //Object
console.log(Person.prototype);
// {
//   constructor: f Person(),
//   __proto__: Object
// }

/**
 * å¦‚å‰æ‰€è¿°ï¼Œæ„é€ å‡½æ•°æœ‰ä¸€ä¸ªprototypeå±æ€§ï¼Œå¼•ç”¨å…¶åŸå‹å¯¹è±¡ï¼Œè€Œè¿™ä¸ªåŸå‹å¯¹è±¡ä¹Ÿæœ‰ä¸€ä¸ªconstructorå±æ€§ï¼Œå¼•ç”¨è¿™ä¸ªæ„é€ å‡½æ•°
 * æ¢å¥è¯è¯´ï¼Œä¸¤è€…å¾ªç¯å¼•ç”¨ï¼š
 * æ„é€ å‡½æ•°constructoræŒ‡å‘å…¶æœ¬èº«
 */
console.log(Person.prototype.constructor === Person); // true

/**
 * æ­£å¸¸çš„åŸå‹é“¾éƒ½ä¼šç»ˆæ­¢äºObjectçš„åŸå‹å¯¹è±¡
 * ObjectåŸå‹çš„åŸå‹æ˜¯null
 */

console.log(Person.prototype.__proto__ === Object.prototype); // true
console.log(Person.prototype.__proto__.constructor === Object); // true
console.log(Person.prototype.__proto__.__proto__ === null); // true
console.log(Person.prototype.__proto__);
// {
//   constructor: f Object(),
//   toString: ...
//   hasOwnProperty: ...
//   isPrototypeOf: ...
//   ...
// }
let person1 = new Person(),
	person2 = new Person();
/**
 * æ„é€ å‡½æ•°ã€åŸå‹å¯¹è±¡å’Œå®ä¾‹
 * æ˜¯3ä¸ªå®Œå…¨ä¸åŒçš„å¯¹è±¡ï¼š
 */

console.log(person1 !== Person); // true
console.log(person1 !== Person.prototype); // true
console.log(Person.prototype !== Person); // true
/**
 * å®ä¾‹é€šè¿‡__proto__é“¾æ¥åˆ°åŸå‹å¯¹è±¡ï¼Œ
 * å®ƒå®é™…ä¸ŠæŒ‡å‘éšè—ç‰¹æ€§[[Prototype]]
 * æ„é€ å‡½æ•°é€šè¿‡prototypeå±æ€§é“¾æ¥åˆ°åŸå‹å¯¹è±¡
 * å®ä¾‹ä¸æ„é€ å‡½æ•°æ²¡æœ‰ç›´æ¥è”ç³»ï¼Œä¸åŸå‹å¯¹è±¡æœ‰ç›´æ¥è”ç³»
 */

console.log(person1.__proto__ === Person.prototype); // true
console.log(person1.__proto__.constructor === Person); // true

/**
 * åŒä¸€ä¸ªæ„é€ å‡½æ•°åˆ›å»ºçš„ä¸¤ä¸ªå®ä¾‹,å…±äº«åŒä¸€ä¸ªåŸå‹å¯¹è±¡ï¼š
 */
console.log(person1.__proto__ === person2.__proto__); // true

/**
 * instanceofæ£€æŸ¥å®ä¾‹çš„åŸå‹é“¾ä¸­æ˜¯å¦åŒ…å«æŒ‡å®šæ„é€ å‡½æ•°çš„åŸå‹
 */
console.log(person1 instanceof Person); // true
console.log(person1 instanceof Object); // true
console.log(Person.prototype instanceof Object); // true
```
